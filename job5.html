<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>XXç”µå•† - æ™ºèƒ½é”€å”®çœ‹æ¿</title>
    <style>
        :root {
            --primary-color: #4facfe;
            --secondary-color: #00f2fe;
            --glass-bg: rgba(255, 255, 255, 0.9);
            --shadow: 0 8px 32px 0 rgba(31, 38, 135, 0.15);
        }

        body {
            font-family: 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            margin: 0;
            padding: 20px;
            color: #333;
        }

        /* å¸ƒå±€å®¹å™¨ */
        .container {
            max-width: 900px;
            margin: 0 auto;
        }

        /* æ¯›ç»ç’ƒå¡ç‰‡é£æ ¼ */
        .card {
            background: var(--glass-bg);
            backdrop-filter: blur(8px);
            border-radius: 16px;
            box-shadow: var(--shadow);
            border: 1px solid rgba(255, 255, 255, 0.18);
            padding: 25px;
            margin-bottom: 20px;
        }

        /* ä¿ç•™äº†ä½œä¸šè¦æ±‚çš„ label å’Œ table åŸºç¡€ç‰¹æ€§ï¼Œä½†åšäº†ç¾åŒ– */
        label {
            display: inline-block;
            width: 100px;
            font-weight: 600;
            color: #555;
        }

        input[type="text"], select {
            padding: 8px 12px;
            border: 1px solid #ddd;
            border-radius: 6px;
            outline: none;
            transition: all 0.3s;
            width: 200px;
            margin-bottom: 10px;
        }

        input[type="text"]:focus, select:focus {
            border-color: var(--primary-color);
            box-shadow: 0 0 8px rgba(79, 172, 254, 0.3);
        }

        /* æŒ‰é’®ç¾åŒ– */
        button {
            background: linear-gradient(to right, var(--primary-color), var(--secondary-color));
            color: white;
            border: none;
            padding: 10px 25px;
            border-radius: 50px;
            font-size: 16px;
            cursor: pointer;
            font-weight: bold;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            transition: transform 0.2s;
        }

        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(0,0,0,0.15);
        }

        /* .clock æ ·å¼ä¼˜åŒ– */
        .clock {
            font-size: 24px;
            font-weight: bold;
            color: #2c3e50;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.1);
            background: rgba(255,255,255,0.5);
            padding: 10px;
            border-radius: 8px;
            display: inline-block;
            margin-bottom: 15px;
        }

        /* è¡¨æ ¼æ ·å¼ä¼˜åŒ– */
        table {
            border-collapse: collapse;
            width: 100%;
            margin-top: 15px;
            background: white;
            border-radius: 8px;
            overflow: hidden;
        }

        th, td {
            border: 1px solid #eee; /* */
            padding: 12px 15px;
            text-align: center;
        }

        th {
            background-color: #f8f9fa;
            color: #444;
            font-weight: bold;
        }

        tr:nth-child(even) {
            background-color: #fdfdfd;
        }

        tr:hover {
            background-color: #f1faff;
        }

        /* ç»“æœå±•ç¤ºåŒºåŸŸ */
        #orderResult h3 { margin-top: 0; color: #2c3e50; }
        .tag {
            display: inline-block;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 12px;
            margin-right: 5px;
            color: white;
        }
        .tag-green { background-color: #2ecc71; }
        .tag-orange { background-color: #f39c12; }
        .tag-blue { background-color: #3498db; }
        .tag-gray { background-color: #95a5a6; }

        /* å¤´éƒ¨ Banner æ ·å¼ */
        .header-banner h1 { margin: 0; font-size: 24px; color: #333; }
        .header-banner p { margin: 5px 0 0; color: #666; }
        
        .alert-box {
            padding: 15px;
            border-radius: 8px;
            margin: 15px 0;
            border-left: 5px solid;
            animation: slideIn 0.5s ease-out;
        }
        
        @keyframes slideIn {
            from { opacity: 0; transform: translateY(-10px); }
            to { opacity: 1; transform: translateY(0); }
        }
    </style>
</head>
<body>

<div class="container">
    <div class="card header-banner">
        <script>
            document.write("<h1>ğŸš€ XXç”µå•† Â· è¿è¥åå° Â· è®¢å•å½•å…¥ä¸é”€å”®çœ‹æ¿</h1>");
            document.write("<p>æ¬¢è¿ä½¿ç”¨å†…éƒ¨å·¥å…·ï¼Œå®æ—¶æŸ¥çœ‹è®¢å•ä¸é”€å”®æƒ…å†µã€‚</p>");

            // å…¨å±€ä¼˜æƒ  + åŠ ä»·æ¸©é¦¨æç¤º
            document.write(`
            <div style="padding:15px; background:#eef9ff; border-left:5px solid #3aa0e6; margin:15px 0; border-radius:4px;">
                <strong style="color:#2c3e50;">ğŸ’¡ æ¸©é¦¨æç¤ºï¼šæœ¬åº—å½“å‰å¯äº«å—çš„ä¼˜æƒ ä¸åŠ ä»·æ”¿ç­–å¦‚ä¸‹ï¼š</strong>
                <ul style="margin:8px 0 0 20px; color:#555;">
                    <li>ğŸ‰ VIP å®¢æˆ·äº«å— <strong>9 æŠ˜ä¼˜æƒ </strong></li>
                    <li>âš¡ åŠ æ€¥å‘è´§ä»·æ ¼ä¼š <strong>x1.1</strong></li>
                    <li>â° æ¯å°æ—¶å‰ 10 åˆ†é’Ÿå†äº« <strong>8.5 æŠ˜</strong></li>
                </ul>
            </div>
            `);

            // é¡µé¢åŠ è½½æ—¶çš„åŠ¨æ€ Banner (åˆ¤æ–­å‰10åˆ†é’Ÿ)
            var nowForBanner = new Date();
            var minuteForBanner = nowForBanner.getMinutes();
            
            if (minuteForBanner >= 0 && minuteForBanner <= 9) {
                document.write(`
                <div class="alert-box" style="background:#fffbe6; border-color:#f4d06f; color:#856404;">
                    â³ <strong>å½“å‰ä¸ºå‰ 10 åˆ†é’Ÿï¼</strong> æœ¬å•å¯é¢å¤–äº«å— <strong style="color:red; font-size:1.2em;">8.5 æŠ˜</strong> æ—¶æ®µä¼˜æƒ ï¼
                </div>
                `);
            } else {
                document.write(`
                <div class="alert-box" style="background:#f8f9fa; border-color:#ccc; color:#666;">
                    ğŸ•’ å°è´´å£«ï¼šæ¯ä¸ªæ•´ç‚¹å‰ 10 åˆ†é’Ÿäº«å— 8.5 æŠ˜ä¼˜æƒ ï¼Œè¯·ç•™æ„ä¸‹å•æ—¶é—´~
                </div>
                `);
            }
        </script>
    </div>

    <div class="card" style="text-align: center;">
        <div id="clock" class="clock">åŠ è½½æ—¶é—´ä¸­...</div>
    </div>

    <div class="card">
        <h2 style="margin-top:0; border-bottom:1px solid #eee; padding-bottom:10px;">ğŸ“ æ–°å»ºè®¢å•</h2>
        
        <div>
            <label>å®¢æˆ·åç§°ï¼š</label>
            <input type="text" id="customerName" placeholder="è¯·è¾“å…¥å®¢æˆ·å§“å">
        </div>
        <div>
            <label>å•†å“å•ä»·(Â¥)ï¼š</label>
            <input type="text" id="priceInput" placeholder="è¾“å…¥æ•°å­—">
        </div>
        <div>
            <label>æ•°é‡ (ä»¶)ï¼š</label>
            <input type="text" id="qtyInput" placeholder="è¾“å…¥æ•´æ•°">
        </div>
        <div>
            <label>å®¢æˆ·ç±»å‹ï¼š</label>
            <select id="customerType">
                <option value="normal">æ™®é€šå®¢æˆ·</option>
                <option value="vip">VIP å®¢æˆ·</option>
            </select>
        </div>
        <div style="margin: 10px 0;">
            <label>åŠ æ€¥å‘è´§ï¼š</label>
            <input type="checkbox" id="urgentFlag" style="width:auto; transform: scale(1.2);"> 
            <span style="color:#e74c3c; font-size:0.9em;">(åŠ æ”¶10%æœåŠ¡è´¹)</span>
        </div>

        <button onclick="validateForm()">â• æ·»åŠ è®¢å•</button>
    </div>

    <div class="card" id="orderResult" style="min-height: 120px;">
        <p style="color:#999; text-align:center; padding-top:30px;">ç­‰å¾…å½•å…¥æ•°æ®...</p>
    </div>

    <div class="card">
        <h2 style="margin-top:0; border-bottom:1px solid #eee; padding-bottom:10px;">ğŸ“Š é”€å”®å†å²çœ‹æ¿</h2>
        <div id="dashboard" style="display:flex; justify-content:space-around; margin-bottom:15px; font-weight:bold; color:#555;">
            <span>æš‚æ— é”€å”®æ•°æ®</span>
        </div>
        <div id="orderTable">
            </div>
    </div>
</div>

<script>
    // å…¨å±€å˜é‡å­˜å‚¨è®¢å•
    var orders = [];

    // åªæœ‰ updateClock å‡½æ•°ï¼šè·å–æ—¶é—´å¹¶æ›´æ–°é¡µé¢
    function padZero(n) {
        return n < 10 ? "0" + n : n;
    }

    function updateClock() {
        var now = new Date();
        var y = now.getFullYear();
        var m = now.getMonth() + 1;
        var d = now.getDate();
        var hh = now.getHours();
        var mm = now.getMinutes();
        var ss = now.getSeconds();

        var weekNames = ["æ—¥", "ä¸€", "äºŒ", "ä¸‰", "å››", "äº”", "å…­"];
        var w = weekNames[now.getDay()];

        var timeStr = y + "å¹´" + padZero(m) + "æœˆ" + padZero(d) + "æ—¥ æ˜ŸæœŸ" + w + " " +
                      padZero(hh) + ":" + padZero(mm) + ":" + padZero(ss);
        
        document.getElementById("clock").innerHTML = "â° " + timeStr;
    }

    // å¯åŠ¨æ—¶é’Ÿ
    updateClock();
    setInterval(updateClock, 1000);


    // æ ¡éªŒè¡¨å•æ•°æ®
    function validateForm() {
        var nameStr = document.getElementById("customerName").value;
        var priceStr = document.getElementById("priceInput").value;
        var qtyStr = document.getElementById("qtyInput").value;
        var typeStr = document.getElementById("customerType").value;
        var urgentChecked = document.getElementById("urgentFlag").checked;

        var valid = true;

        // å®ç°æ ¡éªŒå®¢æˆ·åç§°ä¸èƒ½ä¸ºç©º
        if (nameStr == null || nameStr.trim() === "") {
            alert("âŒ å®¢æˆ·åç§°ä¸èƒ½ä¸ºç©ºï¼"); // ä½¿ç”¨ alert
            valid = false;
        }

        // å•†å“å•ä»·å¿…é¡»æ˜¯å¤§äº 0 çš„æ•°å­—
        var price = parseFloat(priceStr);
        if (isNaN(price) || price <= 0) {
            alert("âŒ å•†å“å•ä»·å¿…é¡»æ˜¯å¤§äº 0 çš„æ•°å­—ï¼");
            valid = false;
        }

        // æ•°é‡å¿…é¡»æ˜¯å¤§äº 0 çš„æ•´æ•°
        var qty = parseInt(qtyStr, 10);
        if (isNaN(qty) || qty <= 0) {
            alert("âŒ æ•°é‡å¿…é¡»æ˜¯å¤§äº 0 çš„æ•´æ•°ï¼");
            valid = false;
        }

        if (!valid) {
            document.getElementById("orderResult").innerHTML = 
                "<p style='color:red; text-align:center;'>â›” è®¢å•å½•å…¥å¤±è´¥ï¼Œè¯·æ£€æŸ¥è¾“å…¥ã€‚</p>";
            return false;
        }

        // æ ¡éªŒé€šè¿‡ï¼Œè°ƒç”¨å¤„ç†å‡½æ•° å‚æ•°ä¼ é€’
        processOrder(nameStr.trim(), price, qty, typeStr === "vip", urgentChecked);
    }

    // æ ¸å¿ƒé€»è¾‘ï¼šè®¡ç®—æŠ˜æ‰£å’ŒåŠ ä»·
    function processOrder(customerName, price, quantity, isVip, isUrgent) {
        
        // â‘ æ­£å¸¸æ€»ä»·
        var baseTotal = price * quantity;

        // â‘¡VIP ä¹æŠ˜
        var afterVip = isVip ? baseTotal * 0.9 : baseTotal;

        // â‘¢åŠ æ€¥ 1.1å€ (æ³¨æ„ä½œä¸šè¦æ±‚æ˜¯åœ¨VIPæŠ˜ååŸºç¡€ä¸Š)
        var afterUrgent = isUrgent ? afterVip * 1.1 : afterVip;

        // â‘£æ—¶é—´æŠ˜æ‰£é€»è¾‘
        var now = new Date();
        var minute = now.getMinutes();
        var hitTimeDiscount = false;
        var finalTotal = afterUrgent;

        // é»˜è®¤çš„åŸºç¡€é€»è¾‘ï¼šå‰10åˆ†é’Ÿ85æŠ˜
        if (minute >= 0 && minute <= 9) {
            finalTotal *= 0.85;
            hitTimeDiscount = true;
        }

        // ============================================================
        // å­¦å·é€»è¾‘åŒºåŸŸ
        // å¦‚æœä½ éœ€è¦å¯ç”¨ç‰¹å®šå­¦å·çš„é€»è¾‘ï¼ˆå¦‚å­¦å·æœ«ä½6ï¼‰ï¼Œ
        // è¯·åœ¨æ­¤å¤„ä¿®æ”¹ä»£ç ã€‚ä¸‹é¢ä»¥â€œå­¦å·æœ«ä½6â€ä¸ºä¾‹çš„æ¼”ç¤ºä»£ç ï¼š
        /*
        // å­¦å·6ï¼šä¸åŠ æ€¥ä¸”æ•°é‡>=2ï¼Œæ‰“98æŠ˜
        // æ³¨æ„ï¼šä½œä¸šä¸­ä¸åŒå­¦å·é€»è¾‘æ˜¯è¦†ç›–æˆ–å åŠ åœ¨é€šç”¨é€»è¾‘ä¸Šçš„ï¼Œå…·ä½“çœ‹è€å¸ˆè¦æ±‚ã€‚
        // è¿™é‡Œä¸ºäº†ä¿è¯ä»£ç é€šç”¨æ€§ï¼Œä¿ç•™äº†ä¸Šæ–¹æ ‡å‡†é€»è¾‘ï¼Œè‹¥è¦å¯ç”¨å­¦å·6é€»è¾‘ï¼Œå–æ¶ˆä¸‹é¢æ³¨é‡Šå³å¯ï¼š
        
        // if (!isUrgent && quantity >= 2) {
        //     finalTotal = finalTotal * 0.98;
        //     console.log("è§¦å‘å­¦å·6é€»è¾‘ï¼šé¢å¤–98æŠ˜");
        // }
        */
        // ============================================================

        var isImportant = isVip && finalTotal > 1000;

        // æ„å»ºè¾“å‡º HTML
        var tipsHtml = "<div style='display:flex; gap:10px; flex-wrap:wrap; margin-top:10px;'>";
        tipsHtml += isVip ? "<span class='tag tag-green'>VIP 9æŠ˜</span>" : "<span class='tag tag-gray'>æ— VIPæŠ˜æ‰£</span>";
        tipsHtml += isUrgent ? "<span class='tag tag-orange'>åŠ æ€¥ x1.1</span>" : "<span class='tag tag-blue'>æ™®é€šé…é€</span>";
        tipsHtml += hitTimeDiscount ? "<span class='tag tag-green'>é™æ—¶ 8.5æŠ˜</span>" : "";
        tipsHtml += "</div>";

        document.getElementById("orderResult").innerHTML = `
            <h3>âœ… è®¢å•å½•å…¥æˆåŠŸ</h3>
            <div style="display:grid; grid-template-columns: 1fr 1fr; gap:10px; background:#f9f9f9; padding:15px; border-radius:8px;">
                <div><strong>å®¢æˆ·åç§°:</strong> ${customerName}</div>
                <div><strong>è®¢å•ç±»å‹:</strong> ${isImportant ? "<span style='color:#e67e22'>â­ å¤§é¢ VIP</span>" : "æ™®é€šè®¢å•"}</div>
                <div><strong>åŸºç¡€é‡‘é¢:</strong> Â¥${baseTotal.toFixed(2)}</div>
                <div><strong>VIPæŠ˜å:</strong> Â¥${afterVip.toFixed(2)}</div>
                <div><strong>åŠ æ€¥å:</strong> Â¥${afterUrgent.toFixed(2)}</div>
                <div style="font-size:1.2em; color:#27ae60;"><strong>æœ€ç»ˆé‡‘é¢:</strong> Â¥${finalTotal.toFixed(2)}</div>
            </div>
            ${tipsHtml}
        `;

        // å°†è®¢å•åŠ å…¥æ•°ç»„
        orders.push({
            name: customerName,
            price: price,
            qty: quantity,
            baseTotal: baseTotal,
            finalTotal: finalTotal,
            isVip: isVip,
            isUrgent: isUrgent,
            hitTimeDiscount: hitTimeDiscount
        });

        // åˆ·æ–°çœ‹æ¿
        renderDashboard();
    }

    // æ¸²æŸ“é”€å”®çœ‹æ¿
    function renderDashboard() {
        var count = orders.length;
        var totalSales = 0;

        for (var i = 0; i < orders.length; i++) {
            totalSales += orders[i].finalTotal;
        }

        var avg = count > 0 ? totalSales / count : 0;

        // æ›´æ–°é¡¶éƒ¨ç»Ÿè®¡
        document.getElementById("dashboard").innerHTML = `
            <div style="text-align:center"><div style="font-size:2em; color:#3498db">${count}</div><div style="font-size:0.8em">æ€»è®¢å•æ•°</div></div>
            <div style="text-align:center"><div style="font-size:2em; color:#2ecc71">Â¥${totalSales.toFixed(0)}</div><div style="font-size:0.8em">é”€å”®æ€»é¢</div></div>
            <div style="text-align:center"><div style="font-size:2em; color:#9b59b6">Â¥${avg.toFixed(0)}</div><div style="font-size:0.8em">å¹³å‡å®¢å•ä»·</div></div>
        `;

        // æ›´æ–°è¡¨æ ¼
        var tableHtml = `
            <table>
                <thead>
                    <tr>
                        <th>å®¢æˆ·</th>
                        <th>å•ä»·</th>
                        <th>æ•°é‡</th>
                        <th>åŸºç¡€é‡‘é¢</th>
                        <th>æœ€ç»ˆé‡‘é¢</th>
                        <th>VIP</th>
                        <th>åŠ æ€¥</th>
                        <th>é™æ—¶æƒ </th>
                    </tr>
                </thead>
                <tbody>
        `;

        // å€’åºæ˜¾ç¤ºï¼Œæœ€æ–°çš„åœ¨æœ€ä¸Šé¢
        for (var j = orders.length - 1; j >= 0; j--) {
            var o = orders[j];
            tableHtml += `
                <tr>
                    <td>${o.name}</td>
                    <td>${o.price.toFixed(2)}</td>
                    <td>${o.qty}</td>
                    <td>${o.baseTotal.toFixed(2)}</td>
                    <td style="color:#27ae60; font-weight:bold;">${o.finalTotal.toFixed(2)}</td>
                    <td>${o.isVip ? "âœ…" : ""}</td>
                    <td>${o.isUrgent ? "âš¡" : ""}</td>
                    <td>${o.hitTimeDiscount ? "â°" : ""}</td>
                </tr>
            `;
        }

        tableHtml += "</tbody></table>";
        document.getElementById("orderTable").innerHTML = tableHtml;
    }

</script>

</body>
</html>